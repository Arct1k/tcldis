<html>
<head>
    <script src="tcldis/web/react-0.11.2.min.js"></script>
    <script src="tcldis/web/JSXTransformer-0.11.2.js"></script>
    <script src="tcldis/web/script.js" type="text/jsx"></script>
    <link  href="tcldis/web/style.css" rel="stylesheet" type="text/css">
    <script src="tcldis.js"></script>
</head>
<body>
<div id="tcldis"></div>
<pre style="display: none;" id="initial_code">set x 5
puts 1
if {$x &lt; 15} {
    puts 1
}
puts 2
foreach {a b} [list 1 2 3 4] {
    puts [expr {$a + $b}]
}
puts 3
catch {my_buggy_proc} {
    puts "the proc failed"
}
puts 4
</pre>
<script type="text/jsx">
/** @jsx React.DOM */
'use strict';

empython.Initialize();
empython.Module.ccall('emtcldis_init', 'number', [], []);
var decompile = empython.Module.cwrap('emtcldis_decompile', 'string', ['string']);

function getInitialCode(cb) {
    setTimeout(function () {
        cb(null, document.getElementById('initial_code').textContent);
    }, 0);
}

function getDecompileSteps(code, cb) {
    var decompiled = JSON.parse(decompile(code));
    cb(null, {'steps': decompiled[0], 'changes': decompiled[1]});
}

React.renderComponent(
    <TclDisUI />,
    document.getElementById('tcldis')
);
</script>
</body>
</html>
